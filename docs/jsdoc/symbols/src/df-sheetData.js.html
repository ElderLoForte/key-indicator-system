<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">//@ts-check</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">/*
<span class='line'>  3</span>         SheetData
<span class='line'>  4</span>         Handles sheet setup, headers, column indices, pulling and pushing data, etc.
<span class='line'>  5</span> */</span><span class="WHIT">
<span class='line'>  6</span> 
<span class='line'>  7</span> 
<span class='line'>  8</span> 
<span class='line'>  9</span> 
<span class='line'> 10</span> 
<span class='line'> 11</span> 
<span class='line'> 12</span> 
<span class='line'> 13</span> </span><span class="COMM">/**
<span class='line'> 14</span>  * An instance of SheetData provides greater access to the data in a Sheet, given certain assumptions about the format of that Sheet. Functions in the Sheet class usually organize data by row, then by column index number; most SheetData functions organize data by row, then by column header string (or hardcoded key string). This preserves structure when reordering columns or moving data between Sheets as long as corresponding columns have identical headers.
<span class='line'> 15</span>  * 
<span class='line'> 16</span>  * When defined, hardcoded key strings can override using header values as key strings. This allows consistant functionality even when the header row changes, and lets methods access specific types of data using the key string without needing the column index for that data. Key strings are hardcoded by being passed through the initialKeyToIndex parameter. Any keys not hardcoded are calculated internally, using the column header as the key string. Columns with blank headers are ignored.
<span class='line'> 17</span>  * 
<span class='line'> 18</span>  * For SheetData to work properly, there must be a single header row. Every nonblank row below the header row is assumed to contain data. Rows above the header row are ignored. Blank data rows (rows whose leftmost value is blank) are skipped, meaning not all SheetData functions preserve them.
<span class='line'> 19</span>  * 
<span class='line'> 20</span>  * Technical note: all of the above functionality is implemented through the hidden RawSheetData class, with SheetData as a wrapper for it.
<span class='line'> 21</span>  */</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="NAME">class</span><span class="WHIT"> </span><span class="NAME">SheetData</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 23</span> 
<span class='line'> 24</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 25</span>      * Wrap a RawSheetData into a full SheetData.
<span class='line'> 26</span>      * @see SheetData
<span class='line'> 27</span>      * @param {RawSheetData} rawSheetData - The RawSheetData to wrap.
<span class='line'> 28</span>      */</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="WHIT">    </span><span class="NAME">constructor</span><span class="PUNC">(</span><span class="NAME">rawSheetData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">        </span><span class="NAME">this.rsd</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rawSheetData</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 32</span> 
<span class='line'> 33</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 34</span>      * Returns the Sheet object for this SheetData.
<span class='line'> 35</span>      */</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">    </span><span class="NAME">getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 39</span> 
<span class='line'> 40</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 41</span>      * Returns the name of the Sheet for this SheetData.
<span class='line'> 42</span>      */</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="WHIT">    </span><span class="NAME">getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 46</span> 
<span class='line'> 47</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 48</span>      * Returns the index, starting with 0, of the header row of this sheet.
<span class='line'> 49</span>      */</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="WHIT">    </span><span class="NAME">getHeaderRow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getHeaderRow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 53</span> 
<span class='line'> 54</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 55</span>      * Returns the index for the column with the given key string.
<span class='line'> 56</span>      * @param {string} key
<span class='line'> 57</span>      */</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="WHIT">    </span><span class="NAME">getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 61</span> 
<span class='line'> 62</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 63</span>      * Returns the key string for the column with the given index.
<span class='line'> 64</span>      * @param {number} index
<span class='line'> 65</span>      */</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="WHIT">    </span><span class="NAME">getKey</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getKey</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 69</span> 
<span class='line'> 70</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 71</span>      * Returns true if this SheetData object has a defined key attached to the given index.
<span class='line'> 72</span>      * @param {number} index
<span class='line'> 73</span>      */</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="WHIT">    </span><span class="NAME">hasIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.hasIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 77</span> 
<span class='line'> 78</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 79</span>      * Returns true if this SheetData object has a defined value for the given key.
<span class='line'> 80</span>      * @param {string} key
<span class='line'> 81</span>      */</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="WHIT">    </span><span class="NAME">hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 85</span> 
<span class='line'> 86</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 87</span>      * Returns the header row of this sheet.
<span class='line'> 88</span>      * @returns {string[]} The header row if this sheet.
<span class='line'> 89</span>      */</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="WHIT">    </span><span class="NAME">getHeaders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getHeaders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 93</span> 
<span class='line'> 94</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'> 95</span>      * Returns the data from this sheet as a two dimensional array. Only includes rows below the header row. Blank rows (rows whose leftmost cell is the empty string) are skipped.
<span class='line'> 96</span>      * @returns {any[][]} The data from this sheet as a two dimentional array.
<span class='line'> 97</span>      */</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="WHIT">    </span><span class="NAME">getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>101</span> 
<span class='line'>102</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>103</span>      * Returns the data from this sheet as an array of objects. Each object represents a row in this sheet and contains the data for that row as properties. Only includes rows below the header row. Blank rows (rows whose leftmost cell is the empty string) are skipped.
<span class='line'>104</span>      * @returns {{}[]} The data from this sheet as an array of objects.
<span class='line'>105</span>      */</span><span class="WHIT">
<span class='line'>106</span> </span><span class="WHIT">    </span><span class="NAME">getData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>107</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>109</span> 
<span class='line'>110</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>111</span>      * Inserts rows of data into the Sheet, formatted as an array of row objects.
<span class='line'>112</span>      * @param {Object} data The data to insert.
<span class='line'>113</span>      */</span><span class="WHIT">
<span class='line'>114</span> </span><span class="WHIT">    </span><span class="NAME">insertData</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>115</span> </span><span class="WHIT">        </span><span class="NAME">this.rsd.insertData</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>117</span> 
<span class='line'>118</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>119</span>      * Inserts rows of data into the Sheet. Takes a 2D array.
<span class='line'>120</span>      * @param {any[][]} values The values to insert.
<span class='line'>121</span>      */</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">    </span><span class="NAME">insertValues</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>123</span> </span><span class="WHIT">        </span><span class="NAME">this.rsd.insertValues</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>125</span> 
<span class='line'>126</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>127</span>      * Clears the content of this Sheet below the header row, leaving formatting intact.
<span class='line'>128</span>      */</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">    </span><span class="NAME">clearContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>130</span> </span><span class="WHIT">        </span><span class="NAME">this.rsd.clearContent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>131</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>132</span> 
<span class='line'>133</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>134</span>      * Returns an array of all the defined keys in this SheetData.
<span class='line'>135</span>      * @returns {string[]} An array of defined keys in this sheet.
<span class='line'>136</span>      */</span><span class="WHIT">
<span class='line'>137</span> </span><span class="WHIT">    </span><span class="NAME">getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>138</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>139</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>140</span> 
<span class='line'>141</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>142</span>      * Returns an array of all the values in the sheet for the given key.
<span class='line'>143</span>      * @returns An array containing all values for the given key.
<span class='line'>144</span>      * @param {string} key The key string.
<span class='line'>145</span>      */</span><span class="WHIT">
<span class='line'>146</span> </span><span class="WHIT">    </span><span class="NAME">getAllOfKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>147</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getAllOfKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>149</span> 
<span class='line'>150</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>151</span>      * Returns an array of all the values in the sheet for the column with the given index.
<span class='line'>152</span>      * @returns An array containing all values from the given column.
<span class='line'>153</span>      * @param {number} index The index of the column, starting from 0.
<span class='line'>154</span>      */</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">    </span><span class="NAME">getAllOfIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rsd.getAllOfIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>158</span> 
<span class='line'>159</span> 
<span class='line'>160</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>161</span> 
<span class='line'>162</span> 
<span class='line'>163</span> 
<span class='line'>164</span> 
<span class='line'>165</span> 
<span class='line'>166</span> 
<span class='line'>167</span> 
<span class='line'>168</span> 
<span class='line'>169</span> 
<span class='line'>170</span> 
<span class='line'>171</span> 
<span class='line'>172</span> 
<span class='line'>173</span> 
<span class='line'>174</span> 
<span class='line'>175</span> </span><span class="COMM">/**
<span class='line'>176</span>  * A RawSheetData instance. This should be wrapped in a SheetData before use.
<span class='line'>177</span>  * @see SheetData
<span class='line'>178</span>  */</span><span class="WHIT">
<span class='line'>179</span> </span><span class="NAME">class</span><span class="WHIT"> </span><span class="NAME">RawSheetData</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>180</span> 
<span class='line'>181</span> </span><span class="WHIT">    </span><span class="COMM">/*
<span class='line'>182</span>     Fields
<span class='line'>183</span>   
<span class='line'>184</span>     tabName: The name of the Sheet this RawSheetData is tied to.
<span class='line'>185</span>     nextFreeColumn: The index of the leftmost column with no defined key.
<span class='line'>186</span>     sheet: The Sheet object this RawSheetData is tied to.
<span class='line'>187</span>     headerRow: The row index of the header row.
<span class='line'>188</span>     
<span class='line'>189</span>     keyToIndex: An object whose properties are keys (strings) representing what data goes in a column (ex "areaID", "stl2", "np").
<span class='line'>190</span>     Its values are the indices (starting with 0) of the column with that data.
<span class='line'>191</span>     indexToKey: The reverse of keyToIndex. An array whose value at a given index is the key corresponding to that index.
<span class='line'>192</span>     */</span><span class="WHIT">
<span class='line'>193</span> 
<span class='line'>194</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>195</span>      * @param {string} tabName - The name of the corresponding Sheet.
<span class='line'>196</span>      * @param {number} headerRow - The row index, starting with 0, of the header row.
<span class='line'>197</span>      * @param {any} initialKeyToIndex - An object containing data about which columns contain hardcoded keys. Formatted as {keyStr: columnIndex ...} where keyStr is a key string and colIndex is the index (starting with 0) of the column to contain that key.
<span class='line'>198</span>      */</span><span class="WHIT">
<span class='line'>199</span> </span><span class="WHIT">    </span><span class="NAME">constructor</span><span class="PUNC">(</span><span class="NAME">tabName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">headerRow</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">initialKeyToIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>200</span> 
<span class='line'>201</span> </span><span class="WHIT">        </span><span class="NAME">this.tabName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tabName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">        </span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">headerRow</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">        </span><span class="NAME">this.keyToIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">initialKeyToIndex</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>204</span> 
<span class='line'>205</span> </span><span class="WHIT">        </span><span class="NAME">this.buildIndexToKey_</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>206</span> 
<span class='line'>207</span> </span><span class="WHIT">        </span><span class="NAME">this.sheet</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SpreadsheetApp.getActiveSpreadsheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getSheetByName</span><span class="PUNC">(</span><span class="NAME">this.tabName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.sheet</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Couldn</span><span class="STRN">'t construct SheetData: no sheet found with name '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.tabName</span><span class="PUNC">}</span><span class="STRN">'`;
<span class='line'>209</span> 
<span class='line'>210</span>     }
<span class='line'>211</span> 
<span class='line'>212</span> 
<span class='line'>213</span> 
<span class='line'>214</span> 
<span class='line'>215</span> 
<span class='line'>216</span> 
<span class='line'>217</span> 
<span class='line'>218</span> 
<span class='line'>219</span>     //Private class methods
<span class='line'>220</span> 
<span class='line'>221</span>     /**
<span class='line'>222</span>      * Build indexToKey, the complement of keyToIndex.
<span class='line'>223</span>      */
<span class='line'>224</span>     buildIndexToKey_() {
<span class='line'>225</span>         let newIndexToKey = [];
<span class='line'>226</span>         for (let key in this.keyToIndex) {
<span class='line'>227</span>             let index = this.keyToIndex[key];
<span class='line'>228</span>             newIndexToKey[index] = key;
<span class='line'>229</span>         }
<span class='line'>230</span>         this.indexToKey = newIndexToKey;
<span class='line'>231</span>     }
<span class='line'>232</span> 
<span class='line'>233</span>     /**
<span class='line'>234</span>      * Get the next blank column not assigned a key. It is NOT guaranteed to eventually return every blank column.
<span class='line'>235</span>      * @returns The next column not assigned a key.
<span class='line'>236</span>      */
<span class='line'>237</span>     getNextFreeColumn_() {
<span class='line'>238</span>         // @ts-ignore
<span class='line'>239</span>         return this.indexToKey.length;
<span class='line'>240</span>     }
<span class='line'>241</span> 
<span class='line'>242</span>     /**
<span class='line'>243</span>      * @param {string} key
<span class='line'>244</span>      * @param {string} header
<span class='line'>245</span>      * @param {number} index
<span class='line'>246</span>      */
<span class='line'>247</span>     addColumnWithHeaderAt_(key, header, index) {
<span class='line'>248</span>         if (key == "") throw new TypeError(`Couldn'</span><span class="NAME">t</span><span class="WHIT"> </span><span class="NAME">add</span><span class="WHIT"> </span><span class="NAME">column</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">.</span><span class="WHIT"> </span><span class="NAME">Invalid</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'${key}'</span><span class="TOKN">`</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">header</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="TOKN">`</span><span class="NAME">Couldn</span><span class="STRN">'t add column to sheet ${this.getTabName()}. Invalid header: '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">header</span><span class="PUNC">}</span><span class="STRN">'`);
<span class='line'>250</span>         if (index &lt; 0) throw new TypeError(`Couldn'</span><span class="NAME">t</span><span class="WHIT"> </span><span class="NAME">add</span><span class="WHIT"> </span><span class="NAME">column</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">.</span><span class="WHIT"> </span><span class="NAME">Invalid</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">index</span><span class="PUNC">}</span><span class="TOKN">`</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> 
<span class='line'>252</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hasIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Potential</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="NAME">collision.</span><span class="WHIT"> </span><span class="NAME">Tried</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">add</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="STRN">'${key}'</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">index</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">but</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="NAME">already</span><span class="WHIT"> </span><span class="NAME">has</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="STRN">'${this.getKey(index)}'</span><span class="TOKN">`</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Potential</span><span class="WHIT"> </span><span class="NAME">data</span><span class="WHIT"> </span><span class="NAME">collision</span><span class="PUNC">!</span><span class="WHIT"> </span><span class="NAME">Tried</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">add</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="STRN">'${key}'</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">index</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">but</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">already</span><span class="WHIT"> </span><span class="NAME">exists</span><span class="WHIT"> </span><span class="NAME">at</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="TOKN">`</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>256</span> 
<span class='line'>257</span> </span><span class="WHIT">        </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRange</span><span class="PUNC">(</span><span class="NAME">this.getHeaderRow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setValue</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> 
<span class='line'>259</span> </span><span class="WHIT">        </span><span class="NAME">this.keyToIndex</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">        </span><span class="COMM">// @ts-ignore</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">        </span><span class="NAME">this.indexToKey</span><span class="PUNC">[</span><span class="NAME">index</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>263</span> 
<span class='line'>264</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>265</span>      * @param {any} key
<span class='line'>266</span>      * @param {any} header
<span class='line'>267</span>      */</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">    </span><span class="NAME">addColumnWithHeader_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">header</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getNextFreeColumn_</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">        </span><span class="NAME">this.addColumnWithHeaderAt_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">header</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>272</span> 
<span class='line'>273</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>274</span>      * @param {any} key
<span class='line'>275</span>      * @param {number} index
<span class='line'>276</span>      */</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">    </span><span class="NAME">addColumnAt_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">header</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">//TODO Add preset headers?</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">        </span><span class="NAME">this.addColumnWithHeaderAt_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">header</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>281</span> 
<span class='line'>282</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>283</span>      * @param {any} key
<span class='line'>284</span>      */</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">    </span><span class="NAME">addColumn_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getNextFreeColumn_</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">        </span><span class="NAME">this.addColumnAt_</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>289</span> 
<span class='line'>290</span> 
<span class='line'>291</span> 
<span class='line'>292</span> 
<span class='line'>293</span> 
<span class='line'>294</span> </span><span class="WHIT">    </span><span class="COMM">/*   Public class methods   */</span><span class="WHIT">
<span class='line'>295</span> 
<span class='line'>296</span> 
<span class='line'>297</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>298</span>      * !!WARNING!!
<span class='line'>299</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>300</span>      * 
<span class='line'>301</span>      * Returns the Sheet object for this RawSheetData.
<span class='line'>302</span>      */</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">    </span><span class="NAME">getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.sheet</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>306</span> 
<span class='line'>307</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>308</span>      * !!WARNING!!
<span class='line'>309</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>310</span>      * 
<span class='line'>311</span>      * Returns the name of the Sheet for this RawSheetData.
<span class='line'>312</span>      */</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">    </span><span class="NAME">getTabName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.tabName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>316</span> 
<span class='line'>317</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>318</span>      * !!WARNING!!
<span class='line'>319</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>320</span>      * 
<span class='line'>321</span>      * Returns the index, starting with 0, of the header row of this sheet.
<span class='line'>322</span>      */</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">    </span><span class="NAME">getHeaderRow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.headerRow</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>326</span> 
<span class='line'>327</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>328</span>      * !!WARNING!!
<span class='line'>329</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>330</span>      * 
<span class='line'>331</span>      * Returns the index for the column with the given key string.
<span class='line'>332</span>      * @param {string} key
<span class='line'>333</span>      */</span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">    </span><span class="NAME">getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Couldn</span><span class="STRN">'t get index from key: key '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">key</span><span class="PUNC">}</span><span class="STRN">' not found in sheet '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.tabName</span><span class="PUNC">}</span><span class="STRN">'`;
<span class='line'>337</span> 
<span class='line'>338</span>         return this.keyToIndex[key];
<span class='line'>339</span>     }
<span class='line'>340</span> 
<span class='line'>341</span>     /**
<span class='line'>342</span>      * !!WARNING!!
<span class='line'>343</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>344</span>      * 
<span class='line'>345</span>      * Returns the key string for the column with the given index.
<span class='line'>346</span>      * @param {number} index
<span class='line'>347</span>      */
<span class='line'>348</span>     getKey(index) {
<span class='line'>349</span>         if (!this.hasIndex(index))
<span class='line'>350</span>             throw `Couldn'</span><span class="NAME">t</span><span class="WHIT"> </span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">from</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="STRN">'${index}'</span><span class="WHIT"> </span><span class="NAME">not</span><span class="WHIT"> </span><span class="NAME">defined</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="STRN">'${this.tabName}'</span><span class="TOKN">`</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> 
<span class='line'>352</span> </span><span class="WHIT">        </span><span class="COMM">// @ts-ignore</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.indexToKey</span><span class="PUNC">[</span><span class="NAME">index</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>355</span> 
<span class='line'>356</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>357</span>      * !!WARNING!!
<span class='line'>358</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>359</span>      * 
<span class='line'>360</span>      * Returns true if this RawSheetData object has a defined key attached to the given index.
<span class='line'>361</span>      * @param {number} index
<span class='line'>362</span>      */</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">    </span><span class="NAME">hasIndex</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>364</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">index</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Tried</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">use</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="NAME">as</span><span class="WHIT"> </span><span class="NAME">an</span><span class="WHIT"> </span><span class="NAME">index</span><span class="TOKN">`</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>365</span> </span><span class="WHIT">        </span><span class="COMM">// @ts-ignore</span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.indexToKey</span><span class="PUNC">[</span><span class="NAME">index</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>368</span> 
<span class='line'>369</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>370</span>      * !!WARNING!!
<span class='line'>371</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>372</span>      * 
<span class='line'>373</span>      * Returns true if this RawSheetData object has a defined value for the given key.
<span class='line'>374</span>      * @param {string} key
<span class='line'>375</span>      */</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">    </span><span class="NAME">hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="TOKN">`</span><span class="NAME">Tried</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">use</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="NAME">as</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">string</span><span class="TOKN">`</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>378</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.keyToIndex</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>379</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>380</span> 
<span class='line'>381</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>382</span>      * !!WARNING!!
<span class='line'>383</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>384</span>      * 
<span class='line'>385</span>      * Returns the header row of this sheet.
<span class='line'>386</span>      * @returns {string[]} The header row if this sheet.
<span class='line'>387</span>      */</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">    </span><span class="NAME">getHeaders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>389</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRange</span><span class="PUNC">(</span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getLastColumn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">range.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>392</span> 
<span class='line'>393</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>394</span>      * !!WARNING!!
<span class='line'>395</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>396</span>      * 
<span class='line'>397</span>      * Returns the data from this sheet as a two dimensional array. Only includes rows below the header row. Blank rows (rows whose leftmost cell is the empty string) are skipped.
<span class='line'>398</span>      * @returns {any[][]} The data from this sheet as a two dimentional array.
<span class='line'>399</span>      */</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">    </span><span class="NAME">getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>402</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">rawValues</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getDataRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">rawValues.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Skip header rows</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">row</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">rawValues</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">values.push</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Skip blank rows</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>407</span> 
<span class='line'>408</span> 
<span class='line'>409</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>410</span>      * !!WARNING!!
<span class='line'>411</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>412</span>      * 
<span class='line'>413</span>      * Returns the data from this sheet as an array of objects. Each object represents a row in this sheet and contains the data for that row as properties. Only includes rows below the header row. Blank rows (rows whose leftmost cell is the empty string) are skipped.
<span class='line'>414</span>      * @returns {{}[]} The data from this sheet as an array of objects.
<span class='line'>415</span>      */</span><span class="WHIT">
<span class='line'>416</span> </span><span class="WHIT">    </span><span class="NAME">getData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>417</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">outValues</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">row</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Skip blank rows</span><span class="WHIT">
<span class='line'>421</span> 
<span class='line'>422</span> </span><span class="WHIT">            </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">rowObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>423</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">row.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>424</span> </span><span class="WHIT">                </span><span class="COMM">// @ts-ignore</span><span class="WHIT">
<span class='line'>425</span> </span><span class="WHIT">                </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.indexToKey</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">                </span><span class="NAME">rowObj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">row</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>428</span> 
<span class='line'>429</span> </span><span class="WHIT">            </span><span class="NAME">outValues.push</span><span class="PUNC">(</span><span class="NAME">rowObj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">outValues</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>433</span> 
<span class='line'>434</span> 
<span class='line'>435</span> 
<span class='line'>436</span> 
<span class='line'>437</span> 
<span class='line'>438</span> 
<span class='line'>439</span> 
<span class='line'>440</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>441</span>      * !!WARNING!!
<span class='line'>442</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>443</span>      *
<span class='line'>444</span>      * Sets the data in the Sheet, erasing data already there. Takes a 2D array.
<span class='line'>445</span>      * @param {any[][]} values The values to insert.
<span class='line'>446</span>      */</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">    </span><span class="NAME">setValues</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">values.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">        </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">insertRowsBefore</span><span class="PUNC">(</span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Insert rows BEFORE the row AFTER the header row, so it won't use header formatting</span><span class="WHIT">
<span class='line'>450</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRange</span><span class="PUNC">(</span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">        </span><span class="NAME">range.setValues</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>453</span> 
<span class='line'>454</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>455</span>      * !!WARNING!!
<span class='line'>456</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>457</span>      *
<span class='line'>458</span>      * Inserts rows of data into the Sheet, formatted as an array of row objects.
<span class='line'>459</span>      * @param {Object} data The data to insert.
<span class='line'>460</span>      */</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">    </span><span class="NAME">setData</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">data.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span> 
<span class='line'>464</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">skippedKeys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">maxIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>467</span> 
<span class='line'>468</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">            </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>470</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>471</span> 
<span class='line'>472</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">                    </span><span class="NAME">skippedKeys.add</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">                    </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">this.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">                    </span><span class="NAME">maxIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">maxIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>478</span> 
<span class='line'>479</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>480</span> </span><span class="WHIT">            </span><span class="NAME">values.push</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>481</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>482</span> 
<span class='line'>483</span> </span><span class="WHIT">        </span><span class="COMM">//Force all rows to be of the same length</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">maxIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>486</span> </span><span class="WHIT">                </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">maxIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>487</span> 
<span class='line'>488</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">skippedKeys</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">            </span><span class="NAME">Logger.log</span><span class="PUNC">(</span><span class="TOKN">`</span><span class="NAME">Skipped</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">key</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="NAME">pushing</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.tabName</span><span class="PUNC">}</span><span class="PUNC">.</span><span class="WHIT"> </span><span class="NAME">Sheet</span><span class="WHIT"> </span><span class="NAME">doesn</span><span class="STRN">'t have that key`);
<span class='line'>490</span> 
<span class='line'>491</span>         this.insertValues(values);
<span class='line'>492</span>     }
<span class='line'>493</span> 
<span class='line'>494</span>     /**
<span class='line'>495</span>      * !!WARNING!!
<span class='line'>496</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>497</span>      *
<span class='line'>498</span>      * Inserts rows of data into the Sheet. Takes a 2D array.
<span class='line'>499</span>      * @param {any[][]} values The values to insert.
<span class='line'>500</span>      */
<span class='line'>501</span>     insertValues(values) {
<span class='line'>502</span>         if (values.length == 0) return;
<span class='line'>503</span>         this.getSheet().insertRowsBefore(this.headerRow + 2, values.length); //Insert rows BEFORE the row AFTER the header row, so it won'</span><span class="NAME">t</span><span class="WHIT"> </span><span class="NAME">use</span><span class="WHIT"> </span><span class="NAME">header</span><span class="WHIT"> </span><span class="NAME">formatting</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getRange</span><span class="PUNC">(</span><span class="NAME">this.headerRow</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">        </span><span class="NAME">range.setValues</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>507</span> 
<span class='line'>508</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>509</span>      * !!WARNING!!
<span class='line'>510</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>511</span>      *
<span class='line'>512</span>      * Sets the data in the Sheet, erasing data already there. Takes an array of row objects.
<span class='line'>513</span>      * @param {Object} data The data to insert.
<span class='line'>514</span>      */</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">    </span><span class="NAME">insertData</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">data.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>517</span> 
<span class='line'>518</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>519</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">skippedKeys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Set</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>520</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">maxIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>521</span> 
<span class='line'>522</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>523</span> </span><span class="WHIT">            </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>524</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>525</span> 
<span class='line'>526</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>527</span> </span><span class="WHIT">                    </span><span class="NAME">skippedKeys.add</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>528</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>529</span> </span><span class="WHIT">                    </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">this.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rowData</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>530</span> </span><span class="WHIT">                    </span><span class="NAME">maxIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">maxIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getIndex</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>531</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>532</span> 
<span class='line'>533</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">            </span><span class="NAME">values.push</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>536</span> 
<span class='line'>537</span> </span><span class="WHIT">        </span><span class="COMM">//Force all rows to be of the same length</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">maxIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">                </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">maxIndex</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>541</span> 
<span class='line'>542</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">of</span><span class="WHIT"> </span><span class="NAME">skippedKeys</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">            </span><span class="NAME">Logger.log</span><span class="PUNC">(</span><span class="TOKN">`</span><span class="NAME">Skipped</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">key</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="NAME">pushing</span><span class="WHIT"> </span><span class="NAME">to</span><span class="WHIT"> </span><span class="NAME">sheet</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">this.tabName</span><span class="PUNC">}</span><span class="PUNC">.</span><span class="WHIT"> </span><span class="NAME">Sheet</span><span class="WHIT"> </span><span class="NAME">doesn</span><span class="STRN">'t have that key`);
<span class='line'>544</span> 
<span class='line'>545</span>         this.insertValues(values);
<span class='line'>546</span>     }
<span class='line'>547</span> 
<span class='line'>548</span> 
<span class='line'>549</span> 
<span class='line'>550</span> 
<span class='line'>551</span> 
<span class='line'>552</span> 
<span class='line'>553</span> 
<span class='line'>554</span> 
<span class='line'>555</span>     /**
<span class='line'>556</span>      * !!WARNING!!
<span class='line'>557</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>558</span>      *
<span class='line'>559</span>      * Clears the content of this Sheet below the header row, leaving formatting intact.
<span class='line'>560</span>      */
<span class='line'>561</span>     clearContent() {
<span class='line'>562</span>         let startRow = this.getHeaderRow() + 2;
<span class='line'>563</span>         let numRows = Math.max(this.getSheet().getLastRow() - startRow);
<span class='line'>564</span>         if (numRows == 0) return; //End if the sheet is already empty
<span class='line'>565</span>         let numCols = this.getSheet().getLastColumn();
<span class='line'>566</span>         this.getSheet().getRange(startRow, 1, numRows, numCols).clearContent();
<span class='line'>567</span>     }
<span class='line'>568</span> 
<span class='line'>569</span>     /**
<span class='line'>570</span>      * !!WARNING!!
<span class='line'>571</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>572</span>      *
<span class='line'>573</span>      * Returns an array of all the defined keys in this RawSheetData.
<span class='line'>574</span>      * @returns {string[]} An array of defined keys in this sheet.
<span class='line'>575</span>      */
<span class='line'>576</span>     getKeys() {
<span class='line'>577</span>         return Object.keys(this.keyToIndex);
<span class='line'>578</span>     }
<span class='line'>579</span> 
<span class='line'>580</span>     /**
<span class='line'>581</span>      * !!WARNING!!
<span class='line'>582</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>583</span>      *
<span class='line'>584</span>      * Returns an array of all the values in the sheet for the given key.
<span class='line'>585</span>      * @returns An array containing all values for the given key.
<span class='line'>586</span>      * @param {string} key The key string.
<span class='line'>587</span>      */
<span class='line'>588</span>     getAllOfKey(key) {
<span class='line'>589</span>         let index = this.keyToIndex[key];
<span class='line'>590</span>         return this.getAllOfIndex(index);
<span class='line'>591</span>     }
<span class='line'>592</span> 
<span class='line'>593</span>     /**
<span class='line'>594</span>      * !!WARNING!!
<span class='line'>595</span>      * This is a direct call to RawSheetData - wrap it in a SheetData instance before using it!
<span class='line'>596</span>      *
<span class='line'>597</span>      * Returns an array of all the values in the sheet for the column with the given index.
<span class='line'>598</span>      * @returns An array containing all values from the given column.
<span class='line'>599</span>      * @param {number} index The index of the column, starting from 0.
<span class='line'>600</span>      */
<span class='line'>601</span>     getAllOfIndex(index) {
<span class='line'>602</span>         let values = this.getValues();
<span class='line'>603</span>         let arr = [];
<span class='line'>604</span> 
<span class='line'>605</span>         for (let row = 0; row &lt; values.length; row++) {
<span class='line'>606</span>             let val = values[row][index];
<span class='line'>607</span>             arr.push(val);
<span class='line'>608</span>         }
<span class='line'>609</span> 
<span class='line'>610</span>         return arr;
<span class='line'>611</span>     }
<span class='line'>612</span> 
<span class='line'>613</span> 
<span class='line'>614</span> 
<span class='line'>615</span> 
<span class='line'>616</span> }
<span class='line'>617</span> 
<span class='line'>618</span> 
<span class='line'>619</span> 
<span class='line'>620</span> 
<span class='line'>621</span> 
<span class='line'>622</span> 
<span class='line'>623</span> 
<span class='line'>624</span> //                The following are basically RawSheetData methods - they form an external constructor, treating RawSheetData like an Enum. They'</span><span class="NAME">re</span><span class="WHIT"> </span><span class="NAME">only</span><span class="WHIT"> </span><span class="NAME">separate</span><span class="WHIT"> </span><span class="NAME">from</span><span class="WHIT"> </span><span class="NAME">the</span><span class="WHIT"> </span><span class="NAME">class</span><span class="WHIT"> </span><span class="NAME">because</span><span class="WHIT"> </span><span class="NAME">static</span><span class="WHIT"> </span><span class="NAME">variables</span><span class="WHIT"> </span><span class="NAME">don</span><span class="STRN">'t work properly in Apps Script.
<span class='line'>625</span> //                populateExtraColumnData()
<span class='line'>626</span> //                sheetDataConstructor()
<span class='line'>627</span> 
<span class='line'>628</span> 
<span class='line'>629</span> 
<span class='line'>630</span> 
<span class='line'>631</span> 
<span class='line'>632</span> 
<span class='line'>633</span> 
<span class='line'>634</span> /**
<span class='line'>635</span>  * @param {any} allSheetData
<span class='line'>636</span>  */
<span class='line'>637</span> function syncDataFlowCols_(allSheetData) {
<span class='line'>638</span>     let formSheetData = allSheetData.form;
<span class='line'>639</span>     let dataSheetData = allSheetData.data;
<span class='line'>640</span> 
<span class='line'>641</span>     let addedKeys = [];
<span class='line'>642</span> 
<span class='line'>643</span>     for (let key of formSheetData.getKeys()) {
<span class='line'>644</span>         if (!dataSheetData.hasKey(key) && !CONFIG.EXCLUDE_FORM_COLS_FROM_DATA.includes(key)) {
<span class='line'>645</span>             let header = formSheetData.getHeaders()[formSheetData.getIndex(key)];
<span class='line'>646</span>             dataSheetData.rsd.addColumnWithHeader_(key, header);
<span class='line'>647</span>             addedKeys.push(key);
<span class='line'>648</span>         }
<span class='line'>649</span>     }
<span class='line'>650</span> 
<span class='line'>651</span>     let addedStr = addedKeys.length == 0 ? '</span><span class="NAME">No</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">columns</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="STRN">' + formSheetData.getTabName() : addedKeys.toString();
<span class='line'>652</span>     console.log(`Added ${addedKeys.length} column(s) to ${dataSheetData.getTabName()}: ` + addedStr);
<span class='line'>653</span> }
<span class='line'>654</span> 
<span class='line'>655</span> 
<span class='line'>656</span> 
<span class='line'>657</span> /**
<span class='line'>658</span>  * Populate this SheetData with column data from the Sheet.
<span class='line'>659</span>  * @param {any} sheetData
<span class='line'>660</span>  */
<span class='line'>661</span> function populateExtraColumnData_(sheetData) {
<span class='line'>662</span>     let headers = sheetData.getHeaders();
<span class='line'>663</span>     for (let i = 0; i &lt; headers.length; i++) {
<span class='line'>664</span>         let key = headers[i];
<span class='line'>665</span>         if (sheetData.hasIndex(i) || key == "") continue; //Skip already defined or blank columns
<span class='line'>666</span>         sheetData.rsd.addColumnAt_(key, i); //Access RawSheetData to add column
<span class='line'>667</span>     }
<span class='line'>668</span> }
<span class='line'>669</span> 
<span class='line'>670</span> 
<span class='line'>671</span> 
<span class='line'>672</span> /**
<span class='line'>673</span>  * @param {{ [x: string]: any; }} allSheetData
<span class='line'>674</span>  */
<span class='line'>675</span> function buildIndexToKey_(allSheetData) {
<span class='line'>676</span>     for (let sdKey in allSheetData) {
<span class='line'>677</span> 
<span class='line'>678</span>         let sd = allSheetData[sdKey];
<span class='line'>679</span> 
<span class='line'>680</span>         sd.indexToKey = [];
<span class='line'>681</span>         for (let key in sd.keyToIndex) {
<span class='line'>682</span>             let i = sd.keyToIndex[key];
<span class='line'>683</span> 
<span class='line'>684</span>             if (typeof sd.indexToKey[i] != '</span><span class="NAME">undefined</span><span class="STRN">')
<span class='line'>685</span>                 throw `Data collision on index ${i} while building indexToKey in SheetData '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">sdKey</span><span class="PUNC">}</span><span class="STRN">' - tried to add key '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">key</span><span class="PUNC">}</span><span class="STRN">' but found value '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">sd.indexToKey</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="STRN">'`;
<span class='line'>686</span> 
<span class='line'>687</span>             sd.indexToKey[i] = key;
<span class='line'>688</span>         }
<span class='line'>689</span> 
<span class='line'>690</span> 
<span class='line'>691</span>     }
<span class='line'>692</span> }
<span class='line'>693</span> 
<span class='line'>694</span> 
<span class='line'>695</span> 
<span class='line'>696</span> 
<span class='line'>697</span> 
<span class='line'>698</span> 
<span class='line'>699</span> 
<span class='line'>700</span> 
<span class='line'>701</span> /**
<span class='line'>702</span>  * WIP - nonfunctional
<span class='line'>703</span>  * @param {SheetData} sheetData
<span class='line'>704</span>  */
<span class='line'>705</span> function setSheetUp_(sheetData) {
<span class='line'>706</span>     throw "UNIMPLEMENTED";
<span class='line'>707</span>     // @ts-ignore
<span class='line'>708</span>     let sheetName = sheetData.getTabName();
<span class='line'>709</span>     let headers = sheetData.getHeaders();
<span class='line'>710</span> 
<span class='line'>711</span>     let ss = SpreadsheetApp.getActiveSpreadsheet();
<span class='line'>712</span>     // @ts-ignore
<span class='line'>713</span>     let ui = SpreadsheetApp.getUi();
<span class='line'>714</span> 
<span class='line'>715</span>     // Checks to see if the sheet exists or not.
<span class='line'>716</span>     let sheet = ss.getSheetByName(sheetName);
<span class='line'>717</span>     if (!sheet) {
<span class='line'>718</span>         Logger.log(`Sheet '</span><span class="NAME">$</span><span class="PUNC">{</span><span class="NAME">sheetName</span><span class="PUNC">}</span><span class="STRN">' not found. Creating`);
<span class='line'>719</span>         sheet = ss.insertSheet(sheetName);
<span class='line'>720</span>         sheet.appendRow(headers);     // Creating Header
<span class='line'>721</span>     }
<span class='line'>722</span> 
<span class='line'>723</span>     return sheet;
<span class='line'>724</span> }
<span class='line'>725</span> 
<span class='line'>726</span> 
<span class='line'>727</span> 
<span class='line'>728</span> 
<span class='line'>729</span> 
<span class='line'>730</span> 
<span class='line'>731</span> 
<span class='line'>732</span> 
<span class='line'>733</span> 
<span class='line'>734</span> /**
<span class='line'>735</span>  * Get all defined instances of SheetData.
<span class='line'>736</span>  * @readonly
<span class='line'>737</span>  * @enum {SheetData}
<span class='line'>738</span>  * @param {Boolean} force - If true, skips checking the cache and forces a recalculation. Default value is false.
<span class='line'>739</span>  */
<span class='line'>740</span> function constructSheetData(force = false) {
<span class='line'>741</span> 
<span class='line'>742</span>     //Check the cache for allSheetData
<span class='line'>743</span>     let cache = CacheService.getDocumentCache();
<span class='line'>744</span>     if (DBCONFIG.CACHE_SHEET_DATA && !force) {
<span class='line'>745</span>         let allSheetData_JSON = cache.get('</span><span class="NAME">allSheetData</span><span class="STRN">');
<span class='line'>746</span>         if (allSheetData_JSON != null) {
<span class='line'>747</span>             Logger.log(`Pulling allSheetData from cache`);
<span class='line'>748</span>             let allSheetData = JSON.parse(allSheetData_JSON);
<span class='line'>749</span>             return allSheetData;
<span class='line'>750</span>         }
<span class='line'>751</span>     }
<span class='line'>752</span> 
<span class='line'>753</span> 
<span class='line'>754</span> 
<span class='line'>755</span>     /*    Static properties and parameters     */
<span class='line'>756</span> 
<span class='line'>757</span> 
<span class='line'>758</span>     const KEY_FROM_HEADER = {     //NOT USED
<span class='line'>759</span>         "Area Name": "areaName",
<span class='line'>760</span>         "Status Log": "log",
<span class='line'>761</span>         "hasContactData": "hasContactData",
<span class='line'>762</span>         "Response Pulled": "responsePulled",
<span class='line'>763</span>         "isDuplicate": "isDuplicate",
<span class='line'>764</span>         "Form Timestamp": "formTimestamp",
<span class='line'>765</span>         "Submission Email": "submissionEmail",
<span class='line'>766</span>         "Area Email": "areaEmail",
<span class='line'>767</span>         "Area ID": "areaID",
<span class='line'>768</span>         "Sunday'</span><span class="NAME">s</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="STRN">": "</span><span class="NAME">kiDate</span><span class="STRN">",
<span class='line'>769</span>         "</span><span class="NAME">NP</span><span class="STRN">": "</span><span class="NAME">np</span><span class="STRN">",
<span class='line'>770</span>         "</span><span class="NAME">SA</span><span class="STRN">": "</span><span class="NAME">sa</span><span class="STRN">",
<span class='line'>771</span>         "</span><span class="NAME">BD</span><span class="STRN">": "</span><span class="NAME">bd</span><span class="STRN">",
<span class='line'>772</span>         "</span><span class="NAME">BC</span><span class="STRN">": "</span><span class="NAME">bc</span><span class="STRN">",
<span class='line'>773</span>         "</span><span class="NAME">RCA</span><span class="STRN">": "</span><span class="NAME">rca</span><span class="STRN">",
<span class='line'>774</span>         "</span><span class="NAME">RC</span><span class="STRN">": "</span><span class="NAME">rc</span><span class="STRN">",
<span class='line'>775</span>         "</span><span class="NAME">CKI</span><span class="STRN">": "</span><span class="NAME">cki</span><span class="STRN">",
<span class='line'>776</span>         "</span><span class="NAME">Service</span><span class="WHIT"> </span><span class="NAME">Hours</span><span class="STRN">": "</span><span class="NAME">serviceHrs</span><span class="STRN">",
<span class='line'>777</span>         "</span><span class="NAME">Form</span><span class="WHIT"> </span><span class="NAME">Notes</span><span class="STRN">": "</span><span class="NAME">formNotes</span><span class="STRN">",
<span class='line'>778</span>         "</span><span class="NAME">Date</span><span class="WHIT"> </span><span class="NAME">Contact</span><span class="WHIT"> </span><span class="NAME">Generated</span><span class="STRN">": "</span><span class="NAME">dateContactGenerated</span><span class="STRN">",
<span class='line'>779</span>         "</span><span class="NAME">Name</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="STRN">": "</span><span class="NAME">name1</span><span class="STRN">",
<span class='line'>780</span>         "</span><span class="NAME">Position</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="STRN">": "</span><span class="NAME">position1</span><span class="STRN">",
<span class='line'>781</span>         "</span><span class="NAME">isTrainer</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="STRN">": "</span><span class="NAME">isTrainer1</span><span class="STRN">",
<span class='line'>782</span>         "</span><span class="NAME">Name</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="STRN">": "</span><span class="NAME">name2</span><span class="STRN">",
<span class='line'>783</span>         "</span><span class="NAME">Position</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="STRN">": "</span><span class="NAME">position2</span><span class="STRN">",
<span class='line'>784</span>         "</span><span class="NAME">isTrainer</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="STRN">": "</span><span class="NAME">isTrainer2</span><span class="STRN">",
<span class='line'>785</span>         "</span><span class="NAME">Name</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="STRN">": "</span><span class="NAME">name3</span><span class="STRN">",
<span class='line'>786</span>         "</span><span class="NAME">Position</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="STRN">": "</span><span class="NAME">position3</span><span class="STRN">",
<span class='line'>787</span>         "</span><span class="NAME">isTrainer</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="STRN">": "</span><span class="NAME">isTrainer3</span><span class="STRN">",
<span class='line'>788</span>         "</span><span class="NAME">District</span><span class="WHIT"> </span><span class="NAME">Leader</span><span class="STRN">": "</span><span class="NAME">districtLeader</span><span class="STRN">",
<span class='line'>789</span>         "</span><span class="NAME">ZL1</span><span class="STRN">": "</span><span class="NAME">zoneLeader1</span><span class="STRN">",
<span class='line'>790</span>         "</span><span class="NAME">ZL2</span><span class="STRN">": "</span><span class="NAME">zoneLeader2</span><span class="STRN">",
<span class='line'>791</span>         "</span><span class="NAME">ZL3</span><span class="STRN">": "</span><span class="NAME">zoneLeader3</span><span class="STRN">",
<span class='line'>792</span>         "</span><span class="NAME">STL1</span><span class="STRN">": "</span><span class="NAME">stl1</span><span class="STRN">",
<span class='line'>793</span>         "</span><span class="NAME">STL2</span><span class="STRN">": "</span><span class="NAME">stl2</span><span class="STRN">",
<span class='line'>794</span>         "</span><span class="NAME">STL3</span><span class="STRN">": "</span><span class="NAME">stl3</span><span class="STRN">",
<span class='line'>795</span>         "</span><span class="NAME">STLT1</span><span class="STRN">": "</span><span class="NAME">stlt1</span><span class="STRN">",
<span class='line'>796</span>         "</span><span class="NAME">STLT2</span><span class="STRN">": "</span><span class="NAME">stlt2</span><span class="STRN">",
<span class='line'>797</span>         "</span><span class="NAME">STLT3</span><span class="STRN">": "</span><span class="NAME">stlt3</span><span class="STRN">",
<span class='line'>798</span>         "</span><span class="NAME">AP1</span><span class="STRN">": "</span><span class="NAME">assistant1</span><span class="STRN">",
<span class='line'>799</span>         "</span><span class="NAME">AP2</span><span class="STRN">": "</span><span class="NAME">assistant2</span><span class="STRN">",
<span class='line'>800</span>         "</span><span class="NAME">AP3</span><span class="STRN">": "</span><span class="NAME">assistant3</span><span class="STRN">",
<span class='line'>801</span>         "</span><span class="NAME">District</span><span class="STRN">": "</span><span class="NAME">district</span><span class="STRN">",
<span class='line'>802</span>         "</span><span class="NAME">Zone</span><span class="STRN">": "</span><span class="NAME">zone</span><span class="STRN">",
<span class='line'>803</span>         "</span><span class="NAME">unitString</span><span class="STRN">": "</span><span class="NAME">unitString</span><span class="STRN">",
<span class='line'>804</span>         "</span><span class="NAME">hasMultipleUnits</span><span class="STRN">": "</span><span class="NAME">hasMultipleUnits</span><span class="STRN">",
<span class='line'>805</span>         "</span><span class="NAME">languageString</span><span class="STRN">": "</span><span class="NAME">languageString</span><span class="STRN">",
<span class='line'>806</span>         "</span><span class="NAME">isSeniorCouple</span><span class="STRN">": "</span><span class="NAME">isSeniorCouple</span><span class="STRN">",
<span class='line'>807</span>         "</span><span class="NAME">isSisterArea</span><span class="STRN">": "</span><span class="NAME">isSisterArea</span><span class="STRN">",
<span class='line'>808</span>         "</span><span class="NAME">hasVehicle</span><span class="STRN">": "</span><span class="NAME">hasVehicle</span><span class="STRN">",
<span class='line'>809</span>         "</span><span class="NAME">Vehicle</span><span class="WHIT"> </span><span class="NAME">Miles</span><span class="STRN">": "</span><span class="NAME">vehicleMiles</span><span class="STRN">",
<span class='line'>810</span>         "</span><span class="NAME">vinLast8</span><span class="STRN">": "</span><span class="NAME">vinLast8</span><span class="STRN">",
<span class='line'>811</span>         "</span><span class="NAME">Apt</span><span class="WHIT"> </span><span class="NAME">Address</span><span class="STRN">": "</span><span class="NAME">aptAddress</span><span class="STRN">",
<span class='line'>812</span>         "</span><span class="NAME">Form</span><span class="WHIT"> </span><span class="NAME">Comments</span><span class="STRN">": "</span><span class="NAME">formNotes</span><span class="STRN">",
<span class='line'>813</span>         "</span><span class="NAME">Folder</span><span class="WHIT"> </span><span class="NAME">Name</span><span class="STRN">": "</span><span class="NAME">folderName</span><span class="STRN">",
<span class='line'>814</span>         "</span><span class="NAME">Parent</span><span class="WHIT"> </span><span class="NAME">Folder</span><span class="STRN">": "</span><span class="NAME">parentFolder</span><span class="STRN">",
<span class='line'>815</span>         "</span><span class="NAME">Folder</span><span class="STRN">": "</span><span class="NAME">folder</span><span class="STRN">",
<span class='line'>816</span>         "</span><span class="NAME">sheetID1</span><span class="STRN">": "</span><span class="NAME">sheetID1</span><span class="STRN">",
<span class='line'>817</span>         "</span><span class="NAME">sheetID2</span><span class="STRN">": "</span><span class="NAME">sheetID2</span><span class="STRN">",
<span class='line'>818</span> 
<span class='line'>819</span> 
<span class='line'>820</span> 
<span class='line'>821</span>     };
<span class='line'>822</span> 
<span class='line'>823</span> 
<span class='line'>824</span> 
<span class='line'>825</span> 
<span class='line'>826</span> 
<span class='line'>827</span> 
<span class='line'>828</span>     const initialColumnOrders = {
<span class='line'>829</span> 
<span class='line'>830</span> 
<span class='line'>831</span>         zoneFilesys: {
<span class='line'>832</span>             "</span><span class="NAME">folderName</span><span class="STRN">": 0,
<span class='line'>833</span>             "</span><span class="NAME">parentFolder</span><span class="STRN">": 1,
<span class='line'>834</span>             "</span><span class="NAME">folder</span><span class="STRN">": 2,
<span class='line'>835</span>             "</span><span class="NAME">sheetID1</span><span class="STRN">": 3,
<span class='line'>836</span>             "</span><span class="NAME">sheetID2</span><span class="STRN">": 4,
<span class='line'>837</span> 
<span class='line'>838</span> 
<span class='line'>839</span> 
<span class='line'>840</span>         },
<span class='line'>841</span>         distFilesys: {
<span class='line'>842</span>             "</span><span class="NAME">folderName</span><span class="STRN">": 0,
<span class='line'>843</span>             "</span><span class="NAME">parentFolder</span><span class="STRN">": 1,
<span class='line'>844</span>             "</span><span class="NAME">folder</span><span class="STRN">": 2,
<span class='line'>845</span>             "</span><span class="NAME">sheetID1</span><span class="STRN">": 3,
<span class='line'>846</span>             "</span><span class="NAME">sheetID2</span><span class="STRN">": 4,
<span class='line'>847</span> 
<span class='line'>848</span> 
<span class='line'>849</span> 
<span class='line'>850</span>         },
<span class='line'>851</span>         areaFilesys: {
<span class='line'>852</span>             "</span><span class="NAME">folderName</span><span class="STRN">": 0,
<span class='line'>853</span>             "</span><span class="NAME">parentFolder</span><span class="STRN">": 1,
<span class='line'>854</span>             "</span><span class="NAME">folder</span><span class="STRN">": 2,
<span class='line'>855</span>             "</span><span class="NAME">sheetID1</span><span class="STRN">": 3,
<span class='line'>856</span>             "</span><span class="NAME">sheetID2</span><span class="STRN">": 4,
<span class='line'>857</span> 
<span class='line'>858</span> 
<span class='line'>859</span> 
<span class='line'>860</span>         },
<span class='line'>861</span> 
<span class='line'>862</span> 
<span class='line'>863</span>         //FORM RESPONSE COLUMN ORDER 
<span class='line'>864</span>         form: {
<span class='line'>865</span>             "</span><span class="NAME">areaName</span><span class="STRN">": 0,
<span class='line'>866</span>             "</span><span class="NAME">responsePulled</span><span class="STRN">": 1,
<span class='line'>867</span>             "</span><span class="NAME">isDuplicate</span><span class="STRN">": 2,
<span class='line'>868</span>             "</span><span class="NAME">formTimestamp</span><span class="STRN">": 3,
<span class='line'>869</span>             "</span><span class="NAME">submissionEmail</span><span class="STRN">": 4,
<span class='line'>870</span>             "</span><span class="NAME">kiDate</span><span class="STRN">": 5,
<span class='line'>871</span>             "</span><span class="NAME">np</span><span class="STRN">": 6,
<span class='line'>872</span>             "</span><span class="NAME">sa</span><span class="STRN">": 7,
<span class='line'>873</span>             "</span><span class="NAME">bd</span><span class="STRN">": 8,
<span class='line'>874</span>             "</span><span class="NAME">bc</span><span class="STRN">": 9,
<span class='line'>875</span>             "</span><span class="NAME">rca</span><span class="STRN">": 10,
<span class='line'>876</span>             "</span><span class="NAME">rc</span><span class="STRN">": 11,
<span class='line'>877</span>             "</span><span class="NAME">cki</span><span class="STRN">": 12,
<span class='line'>878</span>             "</span><span class="NAME">serviceHrs</span><span class="STRN">": 13,
<span class='line'>879</span>             "</span><span class="NAME">formNotes</span><span class="STRN">": 14,
<span class='line'>880</span>             //...additional form data (ex. baptism sources)
<span class='line'>881</span>         },
<span class='line'>882</span> 
<span class='line'>883</span>         //CONTACT SHEET COLUMN ORDER
<span class='line'>884</span>         contact: {
<span class='line'>885</span>             "</span><span class="NAME">dateContactGenerated</span><span class="STRN">": 0,
<span class='line'>886</span>             "</span><span class="NAME">areaEmail</span><span class="STRN">": 1,
<span class='line'>887</span>             "</span><span class="NAME">areaName</span><span class="STRN">": 2,
<span class='line'>888</span>             "</span><span class="NAME">name1</span><span class="STRN">": 3,
<span class='line'>889</span>             "</span><span class="NAME">position1</span><span class="STRN">": 4,
<span class='line'>890</span>             "</span><span class="NAME">isTrainer1</span><span class="STRN">": 5,
<span class='line'>891</span>             "</span><span class="NAME">name2</span><span class="STRN">": 6,
<span class='line'>892</span>             "</span><span class="NAME">position2</span><span class="STRN">": 7,
<span class='line'>893</span>             "</span><span class="NAME">isTrainer2</span><span class="STRN">": 8,
<span class='line'>894</span>             "</span><span class="NAME">name3</span><span class="STRN">": 9,
<span class='line'>895</span>             "</span><span class="NAME">position3</span><span class="STRN">": 10,
<span class='line'>896</span>             "</span><span class="NAME">isTrainer3</span><span class="STRN">": 11,
<span class='line'>897</span>             "</span><span class="NAME">district</span><span class="STRN">": 12,
<span class='line'>898</span>             "</span><span class="NAME">zone</span><span class="STRN">": 13,
<span class='line'>899</span>             "</span><span class="NAME">unitString</span><span class="STRN">": 14,
<span class='line'>900</span>             "</span><span class="NAME">hasMultipleUnits</span><span class="STRN">": 15,
<span class='line'>901</span>             "</span><span class="NAME">languageString</span><span class="STRN">": 16,
<span class='line'>902</span>             "</span><span class="NAME">isSeniorCouple</span><span class="STRN">": 17,
<span class='line'>903</span>             "</span><span class="NAME">isSisterArea</span><span class="STRN">": 18,
<span class='line'>904</span>             "</span><span class="NAME">hasVehicle</span><span class="STRN">": 19,
<span class='line'>905</span>             "</span><span class="NAME">vehicleMiles</span><span class="STRN">": 20,
<span class='line'>906</span>             "</span><span class="NAME">vinLast8</span><span class="STRN">": 21,
<span class='line'>907</span>             "</span><span class="NAME">aptAddress</span><span class="STRN">": 22,
<span class='line'>908</span>         },
<span class='line'>909</span> 
<span class='line'>910</span> 
<span class='line'>911</span>         //DATA SHEET COLUMN ORDER
<span class='line'>912</span>         data: {
<span class='line'>913</span>             "</span><span class="NAME">areaName</span><span class="STRN">": 0,
<span class='line'>914</span>             "</span><span class="NAME">log</span><span class="STRN">": 1,
<span class='line'>915</span>             "</span><span class="NAME">areaEmail</span><span class="STRN">": 2,
<span class='line'>916</span>             "</span><span class="NAME">isDuplicate</span><span class="STRN">": 3,
<span class='line'>917</span>             "</span><span class="NAME">formTimestamp</span><span class="STRN">": 4,    //form data
<span class='line'>918</span>             "</span><span class="NAME">areaID</span><span class="STRN">": 5,
<span class='line'>919</span>             "</span><span class="NAME">kiDate</span><span class="STRN">": 6,    //form data
<span class='line'>920</span> 
<span class='line'>921</span> 
<span class='line'>922</span>             "</span><span class="NAME">np</span><span class="STRN">": 7,    //form data
<span class='line'>923</span>             "</span><span class="NAME">sa</span><span class="STRN">": 8,    //form data
<span class='line'>924</span>             "</span><span class="NAME">bd</span><span class="STRN">": 9,    //form data
<span class='line'>925</span>             "</span><span class="NAME">bc</span><span class="STRN">": 10,    //form data
<span class='line'>926</span>             "</span><span class="NAME">rca</span><span class="STRN">": 11,    //form data
<span class='line'>927</span>             "</span><span class="NAME">rc</span><span class="STRN">": 12,    //form data
<span class='line'>928</span>             "</span><span class="NAME">cki</span><span class="STRN">": 13,    //form data
<span class='line'>929</span>             "</span><span class="NAME">serviceHrs</span><span class="STRN">": 14,    //form data
<span class='line'>930</span> 
<span class='line'>931</span>             "</span><span class="NAME">name1</span><span class="STRN">": 15,
<span class='line'>932</span>             "</span><span class="NAME">position1</span><span class="STRN">": 16,
<span class='line'>933</span>             "</span><span class="NAME">isTrainer1</span><span class="STRN">": 17,
<span class='line'>934</span>             "</span><span class="NAME">name2</span><span class="STRN">": 18,
<span class='line'>935</span>             "</span><span class="NAME">position2</span><span class="STRN">": 19,
<span class='line'>936</span>             "</span><span class="NAME">isTrainer2</span><span class="STRN">": 20,
<span class='line'>937</span>             "</span><span class="NAME">name3</span><span class="STRN">": 21,
<span class='line'>938</span>             "</span><span class="NAME">position3</span><span class="STRN">": 22,
<span class='line'>939</span>             "</span><span class="NAME">isTrainer3</span><span class="STRN">": 23,
<span class='line'>940</span> 
<span class='line'>941</span>             "</span><span class="NAME">districtLeader</span><span class="STRN">": 24,
<span class='line'>942</span>             "</span><span class="NAME">zoneLeader1</span><span class="STRN">": 25,
<span class='line'>943</span>             "</span><span class="NAME">zoneLeader2</span><span class="STRN">": 26,
<span class='line'>944</span>             "</span><span class="NAME">zoneLeader3</span><span class="STRN">": 27,
<span class='line'>945</span>             "</span><span class="NAME">stl1</span><span class="STRN">": 28,
<span class='line'>946</span>             "</span><span class="NAME">stl2</span><span class="STRN">": 29,
<span class='line'>947</span>             "</span><span class="NAME">stl3</span><span class="STRN">": 30,
<span class='line'>948</span>             "</span><span class="NAME">stlt1</span><span class="STRN">": 31,
<span class='line'>949</span>             "</span><span class="NAME">stlt2</span><span class="STRN">": 32,
<span class='line'>950</span>             "</span><span class="NAME">stlt3</span><span class="STRN">": 33,
<span class='line'>951</span>             "</span><span class="NAME">assistant1</span><span class="STRN">": 34,
<span class='line'>952</span>             "</span><span class="NAME">assistant2</span><span class="STRN">": 35,
<span class='line'>953</span>             "</span><span class="NAME">assistant3</span><span class="STRN">": 36,
<span class='line'>954</span> 
<span class='line'>955</span>             "</span><span class="NAME">district</span><span class="STRN">": 37,
<span class='line'>956</span>             "</span><span class="NAME">zone</span><span class="STRN">": 38,
<span class='line'>957</span>             "</span><span class="NAME">unitString</span><span class="STRN">": 39,
<span class='line'>958</span>             "</span><span class="NAME">hasMultipleUnits</span><span class="STRN">": 40,
<span class='line'>959</span>             "</span><span class="NAME">languageString</span><span class="STRN">": 41,
<span class='line'>960</span>             "</span><span class="NAME">isSeniorCouple</span><span class="STRN">": 42,
<span class='line'>961</span>             "</span><span class="NAME">isSisterArea</span><span class="STRN">": 43,
<span class='line'>962</span>             "</span><span class="NAME">hasVehicle</span><span class="STRN">": 44,
<span class='line'>963</span>             "</span><span class="NAME">vehicleMiles</span><span class="STRN">": 45,
<span class='line'>964</span>             "</span><span class="NAME">vinLast8</span><span class="STRN">": 46,
<span class='line'>965</span>             "</span><span class="NAME">aptAddress</span><span class="STRN">": 47,
<span class='line'>966</span>             "</span><span class="NAME">formNotes</span><span class="STRN">": 48,    //form data
<span class='line'>967</span>             //...additional form data (ex. baptism sources)
<span class='line'>968</span>         }
<span class='line'>969</span> 
<span class='line'>970</span>     };
<span class='line'>971</span> 
<span class='line'>972</span> 
<span class='line'>973</span> 
<span class='line'>974</span>     const tabNames = {
<span class='line'>975</span>         form: "</span><span class="NAME">Form</span><span class="WHIT"> </span><span class="NAME">Responses</span><span class="STRN">",
<span class='line'>976</span>         data: "</span><span class="NAME">Data</span><span class="STRN">",
<span class='line'>977</span>         contact: "</span><span class="NAME">Contact</span><span class="WHIT"> </span><span class="NAME">Data</span><span class="STRN">",
<span class='line'>978</span>         zoneFilesys: "</span><span class="NAME">Zone</span><span class="WHIT"> </span><span class="NAME">Filesys</span><span class="WHIT"> </span><span class="NAME">V3</span><span class="STRN">",
<span class='line'>979</span>         distFilesys: "</span><span class="NAME">Dist</span><span class="WHIT"> </span><span class="NAME">Filesys</span><span class="WHIT"> </span><span class="NAME">V3</span><span class="STRN">",
<span class='line'>980</span>         areaFilesys: "</span><span class="NAME">Area</span><span class="WHIT"> </span><span class="NAME">Filesys</span><span class="WHIT"> </span><span class="NAME">V3</span><span class="STRN">"
<span class='line'>981</span>     };
<span class='line'>982</span> 
<span class='line'>983</span>     const headerRows = {
<span class='line'>984</span>         form: 0,
<span class='line'>985</span>         data: 0,
<span class='line'>986</span>         contact: 0,
<span class='line'>987</span>         zoneFilesys: 0,
<span class='line'>988</span>         distFilesys: 0,
<span class='line'>989</span>         areaFilesys: 0
<span class='line'>990</span>     };
<span class='line'>991</span> 
<span class='line'>992</span>     //END Static properties and parameters
<span class='line'>993</span> 
<span class='line'>994</span>     let log = "</span><span class="NAME">Constructed</span><span class="WHIT"> </span><span class="NAME">SheetData</span><span class="WHIT"> </span><span class="NAME">objects</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">";
<span class='line'>995</span> 
<span class='line'>996</span>     //Define SheetData instances
<span class='line'>997</span>     let allSheetData = {};
<span class='line'>998</span>     for (let sdKey in tabNames) {
<span class='line'>999</span>         let rawSheetData = new RawSheetData(tabNames[sdKey], headerRows[sdKey], initialColumnOrders[sdKey]);
<span class='line'>1000</span>         let sheetData = new SheetData(rawSheetData);
<span class='line'>1001</span> 
<span class='line'>1002</span>         populateExtraColumnData_(sheetData);    //Add non-hardcoded key strings
<span class='line'>1003</span> 
<span class='line'>1004</span>         allSheetData[sdKey] = sheetData;
<span class='line'>1005</span>         log += ` '${sheetData.getTabName()}'`;
<span class='line'>1006</span>     }
<span class='line'>1007</span>     console.log(log);
<span class='line'>1008</span> 
<span class='line'>1009</span> //    refreshContacts(allSheetData);
<span class='line'>1010</span> 
<span class='line'>1011</span>     syncDataFlowCols_(allSheetData);
<span class='line'>1012</span> 
<span class='line'>1013</span>     //setSheetsUp_(allSheetData);
<span class='line'>1014</span> 
<span class='line'>1015</span>     //?   Object.freeze(allSheetData);
<span class='line'>1016</span> 
<span class='line'>1017</span> 
<span class='line'>1018</span>     if (DBCONFIG.CACHE_SHEET_DATA) {
<span class='line'>1019</span>         let allSheetData_JSON = JSON.stringify(allSheetData);
<span class='line'>1020</span>         cache.put('allSheetData', allSheetData_JSON, 1800); //cache expiration time set to half an hour
<span class='line'>1021</span>     }
<span class='line'>1022</span> 
<span class='line'>1023</span>     return allSheetData;
<span class='line'>1024</span> }
<span class='line'>1025</span> 
<span class='line'>1026</span> 
<span class='line'>1027</span> 
<span class='line'>1028</span> 
<span class='line'>1029</span> 
<span class='line'>1030</span> 
<span class='line'>1031</span> 
<span class='line'>1032</span> 
<span class='line'>1033</span> function testSheetData() {
<span class='line'>1034</span>     let allSheetData = constructSheetData();
<span class='line'>1035</span> 
<span class='line'>1036</span>     Logger.log("</span><span class="NAME">Data</span><span class="WHIT"> </span><span class="NAME">SheetData</span><span class="PUNC">:</span><span class="STRN">");
<span class='line'>1037</span>     Logger.log(allSheetData.data);
<span class='line'>1038</span> 
<span class='line'>1039</span>     Logger.log("</span><span class="NAME">Headers</span><span class="PUNC">:</span><span class="TOKN"></span></pre></body></html>