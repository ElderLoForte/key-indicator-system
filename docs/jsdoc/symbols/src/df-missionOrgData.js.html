<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">//@ts-check</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">/*
<span class='line'>  3</span>         missionOrgData
<span class='line'>  4</span>         Functions managing mission organization data.
<span class='line'>  5</span>         Pulls from the Contact Data sheet.
<span class='line'>  6</span>         getMissionOrgData()
<span class='line'>  7</span>         getMissionLeadershipData()
<span class='line'>  8</span>         getLeadershipAreaData()
<span class='line'>  9</span> */</span><span class="WHIT">
<span class='line'> 10</span> 
<span class='line'> 11</span> 
<span class='line'> 12</span> 
<span class='line'> 13</span> </span><span class="COMM">/**
<span class='line'> 14</span> * Returns an object containing mission organization data, including zones, districts in each zone, and areas in each district.
<span class='line'> 15</span> * @param {{ contact: any; }} allSheetData
<span class='line'> 16</span> * @returns {any}
<span class='line'> 17</span> */</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getMissionOrgData</span><span class="PUNC">(</span><span class="NAME">allSheetData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 19</span> 
<span class='line'> 20</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">allSheetData.contact</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 21</span> 
<span class='line'> 22</span> </span><span class="WHIT">    </span><span class="NAME">Logger.log</span><span class="PUNC">(</span><span class="STRN">"Calculating mission organization data..."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 23</span> 
<span class='line'> 24</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zones</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 25</span> 
<span class='line'> 26</span> </span><span class="WHIT">    </span><span class="COMM">/*    Format of zones object
<span class='line'> 27</span>     zones = {
<span class='line'> 28</span>       "ZONE1": {
<span class='line'> 29</span>         "hasStlArea": false,
<span class='line'> 30</span>         "DIST1": {
<span class='line'> 31</span>           "AREA1",
<span class='line'> 32</span>           "AREA2"...
<span class='line'> 33</span>         },
<span class='line'> 34</span>         "DIST2": {...}
<span class='line'> 35</span>       },
<span class='line'> 36</span>       "ZONE2": {...}
<span class='line'> 37</span>     }
<span class='line'> 38</span>     */</span><span class="WHIT">
<span class='line'> 39</span> 
<span class='line'> 40</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaID</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 41</span> 
<span class='line'> 42</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">[</span><span class="NAME">areaID</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">areaData</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 43</span> 
<span class='line'> 44</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">area</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">district</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.district</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.zone</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 47</span> 
<span class='line'> 48</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="COMM">//Initialize zones[zone]</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="WHIT">            </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 50</span> 
<span class='line'> 51</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="COMM">//Initialize</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="WHIT">            </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 53</span> 
<span class='line'> 54</span> </span><span class="WHIT">        </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">area</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 55</span> 
<span class='line'> 56</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 57</span> 
<span class='line'> 58</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">zones</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 60</span> 
<span class='line'> 61</span> 
<span class='line'> 62</span> 
<span class='line'> 63</span> </span><span class="COMM">/**
<span class='line'> 64</span>  * Calculates and returns an object containing mission leadership data, including area names, emails, and missionary names of every junior missionary leader, as well as flags indicating if each zone has an STL area and whether an STLT area exists.
<span class='line'> 65</span>  * @param {{ [x: string]: any; }} contacts
<span class='line'> 66</span>  */</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getMissionLeadershipData</span><span class="PUNC">(</span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 68</span> 
<span class='line'> 69</span> </span><span class="WHIT">    </span><span class="NAME">Logger.log</span><span class="PUNC">(</span><span class="STRN">"Calculating leader data from contact data..."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> 
<span class='line'> 71</span> 
<span class='line'> 72</span> </span><span class="WHIT">    </span><span class="COMM">//Initialized to the empty string to guarantee a defined value</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">apArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="WHIT">        </span><span class="NAME">ap1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="WHIT">        </span><span class="NAME">ap2</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="WHIT">        </span><span class="NAME">ap3</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">stltArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="WHIT">        </span><span class="NAME">stlt1</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="WHIT">        </span><span class="NAME">stlt2</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="WHIT">        </span><span class="NAME">stlt3</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">hasStltArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 84</span> 
<span class='line'> 85</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zones</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span> 
<span class='line'> 87</span> 
<span class='line'> 88</span> 
<span class='line'> 89</span> 
<span class='line'> 90</span> 
<span class='line'> 91</span> </span><span class="WHIT">    </span><span class="COMM">/*    REFERENCE
<span class='line'> 92</span>   
<span class='line'> 93</span>   
<span class='line'> 94</span>         Object format of zones:
<span class='line'> 95</span>       zones = {
<span class='line'> 96</span>   
<span class='line'> 97</span>         "ZONE1" : {
<span class='line'> 98</span>           "districts" : {...},
<span class='line'> 99</span>           "hasStlArea" : true,
<span class='line'>100</span>           "zlArea" : {zl1: "", zl2: "", zl3: "", areaID: "", areaName: "", areaEmail: ""},
<span class='line'>101</span>           "stlArea" : {stl contact data}
<span class='line'>102</span>         },
<span class='line'>103</span>         
<span class='line'>104</span>         "ZONE2"...
<span class='line'>105</span>       }
<span class='line'>106</span>   
<span class='line'>107</span>   
<span class='line'>108</span>       Object format of zones[zone].districts:     
<span class='line'>109</span>       zones[zone].districts = {
<span class='line'>110</span>         "DIST1" : {areas: {...}, dl: "", areaID: "", areaName: "", areaEmail: ""},
<span class='line'>111</span>         "DIST2"...
<span class='line'>112</span>       }
<span class='line'>113</span>   
<span class='line'>114</span>   
<span class='line'>115</span>       Object format of zones[zone].districts[district].areas:         Note - areas contains all the areas in the district, including leader areas.
<span class='line'>116</span>       zones[zone].districts[district].areas = {
<span class='line'>117</span>         "areaID1" : {areaName:"", areaEmail: ""},
<span class='line'>118</span>         "areaID2" : {...}
<span class='line'>119</span>         ...
<span class='line'>120</span>       }
<span class='line'>121</span>   
<span class='line'>122</span>   
<span class='line'>123</span>   
<span class='line'>124</span>   
<span class='line'>125</span>     */</span><span class="WHIT">
<span class='line'>126</span> 
<span class='line'>127</span> 
<span class='line'>128</span> 
<span class='line'>129</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaID</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>130</span> 
<span class='line'>131</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">[</span><span class="NAME">areaID</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>132</span> 
<span class='line'>133</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">area</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">district</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.district</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.zone</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>136</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>137</span> 
<span class='line'>138</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//Initialize zones[zone], as well as its properties</span><span class="WHIT">
<span class='line'>139</span> </span><span class="WHIT">            </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">                </span><span class="STRN">"districts"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">                </span><span class="STRN">"zlArea"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">                </span><span class="STRN">"stlArea"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>143</span> </span><span class="WHIT">                </span><span class="STRN">"hasStlArea"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>146</span> 
<span class='line'>147</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//Initialize districts[district], as well as its properties</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">            </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">                </span><span class="STRN">"areas"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">                </span><span class="STRN">"dlArea"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>151</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>153</span> 
<span class='line'>154</span> </span><span class="WHIT">        </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">areas</span><span class="PUNC">[</span><span class="NAME">area</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//Set areas[area]</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">            </span><span class="STRN">"areaEmail"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">areaEmail</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">            </span><span class="STRN">"areaID"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">areaID</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>158</span> 
<span class='line'>159</span> 
<span class='line'>160</span> 
<span class='line'>161</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//i is the companion number (for ZL1,2,3 etc.)</span><span class="WHIT">
<span class='line'>162</span> 
<span class='line'>163</span> 
<span class='line'>164</span> </span><span class="WHIT">            </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"position"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>165</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos.match</span><span class="PUNC">(</span><span class="REGX">/.*[123]/</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>166</span> </span><span class="WHIT">                </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pos.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pos.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Ex. "ZL1" => "ZL"</span><span class="WHIT">
<span class='line'>167</span> 
<span class='line'>168</span> 
<span class='line'>169</span> 
<span class='line'>170</span> </span><span class="WHIT">            </span><span class="COMM">/*  IMPORTANT NOTE (as of 2021):      
<span class='line'>171</span>               STL, STLT, AP, and SA are assumed to not be trainers.
<span class='line'>172</span>       
<span class='line'>173</span>               STLs are supported on the mission-office level, but are not fully implemented.
<span class='line'>174</span>       
<span class='line'>175</span>               This is because IMOS doesn't keep track of which zones an STL covers, and STL
<span class='line'>176</span>               areas can cover multiple zones. For a zone without STLs, the system has no
<span class='line'>177</span>               way of knowing which STLs cover it. It would have to be input manually, like
<span class='line'>178</span>               through a spreadsheet that the APs update regularly by hand.
<span class='line'>179</span>               
<span class='line'>180</span>             */</span><span class="WHIT">
<span class='line'>181</span> 
<span class='line'>182</span> </span><span class="WHIT">            </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>183</span> 
<span class='line'>184</span> </span><span class="WHIT">                </span><span class="COMM">//Third companion in a duo</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>187</span> 
<span class='line'>188</span> </span><span class="WHIT">                </span><span class="COMM">// Senior Comp, Junior Comp, Trainer</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"SC"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>190</span> 
<span class='line'>191</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>192</span> 
<span class='line'>193</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"JC"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>194</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>195</span> 
<span class='line'>196</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"TR"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>198</span> 
<span class='line'>199</span> </span><span class="WHIT">                </span><span class="COMM">// District Leader</span><span class="WHIT">
<span class='line'>200</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"DL"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>201</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.dl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>206</span> 
<span class='line'>207</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"DT"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.dl</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>209</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>210</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>211</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>213</span> 
<span class='line'>214</span> </span><span class="WHIT">                </span><span class="COMM">// ZL</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ZL"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea</span><span class="PUNC">[</span><span class="STRN">"zl"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>221</span> 
<span class='line'>222</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"ZLT"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea</span><span class="PUNC">[</span><span class="STRN">"zl"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span> 
<span class='line'>229</span> </span><span class="WHIT">                </span><span class="COMM">//STL (STLs with greenies are not currently supported)</span><span class="WHIT">
<span class='line'>230</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"STL"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>231</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasStlArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>232</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea</span><span class="PUNC">[</span><span class="STRN">"zl"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>233</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">                    </span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>237</span> 
<span class='line'>238</span> </span><span class="WHIT">                </span><span class="COMM">// AP, STLT</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"AP"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>240</span> </span><span class="WHIT">                    </span><span class="NAME">apArea</span><span class="PUNC">[</span><span class="STRN">"ap"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>241</span> </span><span class="WHIT">                    </span><span class="NAME">apArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">                    </span><span class="NAME">apArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">                    </span><span class="NAME">apArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"STLT"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">                    </span><span class="NAME">hasStltArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">                    </span><span class="NAME">stltArea</span><span class="PUNC">[</span><span class="STRN">"stlt"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="PUNC">[</span><span class="STRN">"name"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">                    </span><span class="NAME">stltArea.areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">                    </span><span class="NAME">stltArea.areaEmail</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaEmail</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">                    </span><span class="NAME">stltArea.areaID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>252</span> 
<span class='line'>253</span> </span><span class="WHIT">                </span><span class="COMM">// Special Assignment - office missionaries might have this</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">                </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"SA"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">                    </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>256</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>257</span> 
<span class='line'>258</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>259</span> 
<span class='line'>260</span> 
<span class='line'>261</span> 
<span class='line'>262</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>263</span> 
<span class='line'>264</span> 
<span class='line'>265</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">        </span><span class="NAME">zones</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">zones</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">        </span><span class="NAME">apArea</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">apArea</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">        </span><span class="NAME">stltArea</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">stltArea</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">        </span><span class="NAME">hasStltArea</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">hasStltArea</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">        </span><span class="NAME">log</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">leaderDataCalculatedTime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> 
<span class='line'>273</span> 
<span class='line'>274</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>275</span> 
<span class='line'>276</span> 
<span class='line'>277</span> 
<span class='line'>278</span> 
<span class='line'>279</span> 
<span class='line'>280</span> 
<span class='line'>281</span> </span><span class="COMM">/**
<span class='line'>282</span>  * Returns an object whose properties (keyed by areaID) represent areas. Each area contains the names of the DL, ZLs, APs, etc. with stewardship over that area.
<span class='line'>283</span>  * @param {{ [x: string]: any; }} contacts
<span class='line'>284</span>  */</span><span class="WHIT">
<span class='line'>285</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getLeadershipAreaData</span><span class="PUNC">(</span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>286</span> 
<span class='line'>287</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">leaderData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">getMissionLeadershipData</span><span class="PUNC">(</span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> 
<span class='line'>289</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zones</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leaderData.zones</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>290</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">apArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leaderData.apArea</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>291</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">stltArea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">leaderData.stltArea</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>292</span> 
<span class='line'>293</span> </span><span class="WHIT">    </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">leaderAreaData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> 
<span class='line'>295</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaID</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span> 
<span class='line'>297</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">contacts</span><span class="PUNC">[</span><span class="NAME">areaID</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>298</span> 
<span class='line'>299</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">zone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.zone</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">district</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.district</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">        </span><span class="NAME">let</span><span class="WHIT"> </span><span class="NAME">areaName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">areaData.areaName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> 
<span class='line'>303</span> </span><span class="WHIT">        </span><span class="NAME">leaderAreaData</span><span class="PUNC">[</span><span class="NAME">areaID</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">            </span><span class="STRN">"areaName"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">areaName</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">//Debug purposes - not actually used</span><span class="WHIT">
<span class='line'>305</span> 
<span class='line'>306</span> </span><span class="WHIT">            </span><span class="STRN">"districtLeader"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">districts</span><span class="PUNC">[</span><span class="NAME">district</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dlArea.dl</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">            </span><span class="STRN">"zoneLeader1"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.zl1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">            </span><span class="STRN">"zoneLeader2"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.zl2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">            </span><span class="STRN">"zoneLeader3"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">zlArea.zl3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">            </span><span class="STRN">"stl1"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.stl1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">            </span><span class="STRN">"stl2"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.stl2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">            </span><span class="STRN">"stl3"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">zones</span><span class="PUNC">[</span><span class="NAME">zone</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">stlArea.stl3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">            </span><span class="STRN">"assistant1"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">apArea.ap1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">            </span><span class="STRN">"assistant2"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">apArea.ap2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">            </span><span class="STRN">"assistant3"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">apArea.ap3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">            </span><span class="STRN">"stlt1"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">stltArea.stlt1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">            </span><span class="STRN">"stlt2"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">stltArea.stlt2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">            </span><span class="STRN">"stlt3"</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">stltArea.stlt3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>319</span> 
<span class='line'>320</span> </span><span class="WHIT">            </span><span class="STRN">"log"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>321</span> </span><span class="WHIT">            </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>322</span> </span><span class="WHIT">                </span><span class="NAME">leaderDataPulled</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">                </span><span class="NAME">leaderDataCalculatedTime</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">leaderData.log.leaderDataCalculatedTime</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>325</span> 
<span class='line'>326</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>327</span> 
<span class='line'>328</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>329</span> 
<span class='line'>330</span> 
<span class='line'>331</span> </span><span class="WHIT">    </span><span class="NAME">Logger.log</span><span class="PUNC">(</span><span class="STRN">"Finished calculating leadership data for each area."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>332</span> 
<span class='line'>333</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">leaderAreaData</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>334</span> 
<span class='line'>335</span> 
<span class='line'>336</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='line'>337</span>      * @param {string} obj
<span class='line'>338</span>      */</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">    </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">rmvUnd</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>342</span> 
<span class='line'>343</span> 
<span class='line'>344</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>345</span> 
<span class='line'>346</span> 
<span class='line'>347</span> 
<span class='line'>348</span> 
<span class='line'>349</span> 
<span class='line'>350</span> 
<span class='line'>351</span> 
<span class='line'>352</span> 
<span class='line'>353</span> 
<span class='line'>354</span> 
<span class='line'>355</span> 
<span class='line'>356</span> 
<span class='line'>357</span> 
<span class='line'>358</span> 
<span class='line'>359</span> 
<span class='line'>360</span> 
<span class='line'>361</span> 
<span class='line'>362</span> 
<span class='line'>363</span> 
<span class='line'>364</span> 
<span class='line'>365</span> 
<span class='line'>366</span> </span></pre></body></html>